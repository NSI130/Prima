<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Penerima & Pengirim Interaktif</title>
<style>
  /* Warna soft pastel dan font nyaman */
  :root {
    --color-bg: #f9f9fb;
    --color-primary: #6a8caf;
    --color-primary-dark: #557799;
    --color-secondary: #a3c4f3;
    --color-accent: #f7d6e0;
    --color-success: #3a7d44;
    --color-error: #d03e3e;
    --color-text: #3a3a3a;
    --color-input-bg: #fff;
    --radius: 12px;
  }

  * {
    box-sizing: border-box;
  }

  body {
    margin: 0; padding: 30px 15px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--color-bg);
    color: var(--color-text);
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 28px;
    min-height: 100vh;
  }

  .box {
    background: var(--color-input-bg);
    border-radius: var(--radius);
    padding: 28px 32px;
    box-shadow: 0 8px 25px rgba(106,140,175,0.15);
    width: 100%;
    max-width: 380px;
    display: flex;
    flex-direction: column;
    user-select: none;
  }

  h2 {
    margin: 0 0 18px;
    color: var(--color-primary);
    text-align: center;
    font-weight: 700;
    font-size: 1.4rem;
  }

  label {
    font-weight: 600;
    margin-bottom: 8px;
    display: block;
    color: #455a75;
    user-select: text;
  }

  input, textarea {
    width: 100%;
    background: var(--color-input-bg);
    border: 2px solid #cdd7e0;
    border-radius: var(--radius);
    padding: 12px 16px;
    font-size: 1rem;
    font-family: inherit;
    transition: border-color 0.3s ease, box-shadow 0.25s ease;
    resize: vertical;
    min-height: 44px;
  }
  textarea {
    min-height: 100px;
  }
  input:focus, textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 8px var(--color-primary-dark);
  }

  button {
    margin-top: auto;
    background: var(--color-primary);
    border: none;
    padding: 14px 0;
    border-radius: var(--radius);
    font-weight: 700;
    font-size: 1.15rem;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  button:hover:not(:disabled) {
    background: var(--color-primary-dark);
  }
  button:disabled {
    background: var(--color-primary);
    opacity: 0.55;
    cursor: not-allowed;
  }

  .message {
    margin-top: 18px;
    min-height: 42px;
    font-weight: 600;
    font-size: 1rem;
    text-align: center;
    color: var(--color-success);
    padding: 12px 16px;
    border-radius: var(--radius);
    background: #e7f3e7;
    box-shadow: inset 0 0 5px rgba(58,125,68,0.15);
    white-space: pre-wrap;
    user-select: text;
  }

  .message.error {
    color: var(--color-error);
    background: #fbe6e6;
    box-shadow: inset 0 0 6px rgba(208,62,62,0.3);
  }

  .spinner {
    margin: 14px auto;
    width: 36px;
    height: 36px;
    border: 5px solid #cdd7e0;
    border-top-color: var(--color-primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Animasi ketik (typing effect) */
  @keyframes typing {
    from { width: 0 }
    to { width: 100% }
  }
  @keyframes blink {
    50% { border-color: transparent }
  }

  .typing-text {
    font-family: 'Courier New', Courier, monospace;
    overflow: hidden;
    border-right: 2px solid var(--color-primary);
    white-space: nowrap;
    animation:
      typing 1.5s steps(40, end),
      blink 0.7s step-end infinite;
  }

  /* Responsive */
  @media (min-width: 800px) {
    body {
      justify-content: center;
      padding: 40px 20px;
    }
    .box {
      width: 360px;
    }
  }
</style>
</head>
<body>

<div class="box" aria-label="Bagian Penerima">
  <h2>Cek deh, ada pesan untukmu ngga</h2>
  <label for="namaPenerima">Masukkan namamu</label>
  <input type="text" id="namaPenerima" placeholder="Tulis namamu di sini..." autocomplete="off" aria-describedby="statusPenerima" />
  <button id="cekPesanBtn" aria-controls="statusPenerima" aria-live="polite">Cek Pesan</button>
  <div id="statusPenerima" class="message" role="region" aria-live="polite" aria-atomic="true"></div>
</div>

<div class="box" aria-label="Bagian Pengirim">
  <h2>Kirim Pesan Rahasia</h2>
  <label for="namaUntuk">Untuk siapa?</label>
  <input type="text" id="namaUntuk" placeholder="Nama penerima pesan" autocomplete="off" />
  
  <label for="pesanKirim">Isi Pesan</label>
  <textarea id="pesanKirim" placeholder="Tulis pesanmu di sini..."></textarea>
  
  <label for="passwordKirim">Password Rahasia</label>
  <input type="password" id="passwordKirim" placeholder="Masukkan password rahasia" autocomplete="off" />
  
  <button id="kirimPesanBtn">Kirim Pesan</button>
  <div id="statusPengirim" class="message" role="region" aria-live="polite" aria-atomic="true"></div>
</div>

<script>
  // Database pesan simulasi, case insensitive key
  const dbPesan = {
    'prima': ['Hai Prima! Semangat terus ya!', 'Jangan lupa makan yang teratur ðŸ˜Š'],
    'nashri': ['Halo Nashri, tetap jaga kesehatan!'],
  };

  const btnCek = document.getElementById('cekPesanBtn');
  const inputNamaPenerima = document.getElementById('namaPenerima');
  const statusPenerima = document.getElementById('statusPenerima');

  const btnKirim = document.getElementById('kirimPesanBtn');
  const inputNamaUntuk = document.getElementById('namaUntuk');
  const inputPesanKirim = document.getElementById('pesanKirim');
  const inputPassword = document.getElementById('passwordKirim');
  const statusPengirim = document.getElementById('statusPengirim');

  // Fungsi menampilkan spinner loading
  function showSpinner(target) {
    target.innerHTML = '<div class="spinner" aria-label="Memuat..."></div>';
  }

  // Fungsi menghapus spinner dan menampilkan pesan dengan animasi ketik
  function hideSpinnerWithTyping(target, text, isError = false) {
    target.classList.toggle('error', isError);
    target.textContent = ''; // Clear dulu

    // Animasi ketik
    let i = 0;
    const speed = 40;
    function typeWriter() {
      if (i < text.length) {
        target.textContent += text.charAt(i);
        i++;
        setTimeout(typeWriter, speed);
      }
    }
    typeWriter();
  }

  // Event cek pesan penerima
  btnCek.addEventListener('click', () => {
    const namaRaw = inputNamaPenerima.value.trim();
    if (!namaRaw) {
      statusPenerima.classList.add('error');
      statusPenerima.textContent = 'Tolong isi namamu dulu ya!';
      return;
    }
    statusPenerima.classList.remove('error');
    showSpinner(statusPenerima);

    setTimeout(() => {
      const namaLower = namaRaw.toLowerCase();
      const pesanList = dbPesan[namaLower];

      if (pesanList && pesanList.length > 0) {
        // Gabungkan semua pesan dengan numbering
        const semuaPesan = pesanList.map((p,i) => `${i+1}. ${p}`).join('\n\n');
        hideSpinnerWithTyping(statusPenerima, semuaPesan);
      } else {
        hideSpinnerWithTyping(statusPenerima, 
          'Maaf, belum ada pesan untukmu. Tetap semangat dan jangan menyerah!', false);
      }
    }, 1500);
  });

  // Event kirim pesan pengirim
  btnKirim.addEventListener('click', () => {
    const namaUntukRaw = inputNamaUntuk.value.trim();
    const pesanKirimRaw = inputPesanKirim.value.trim();
    const passRaw = inputPassword.value;

    statusPengirim.classList.remove('error');

    if (!namaUntukRaw || !pesanKirimRaw || !passRaw) {
      statusPengirim.classList.add('error');
      statusPengirim.textContent = 'Semua kolom harus diisi ya!';
      return;
    }
    if (passRaw !== 'AraCintaNashri') {
      statusPengirim.classList.add('error');
      statusPengirim.textContent = 'Password rahasia salah, coba lagi ya!';
      return;
    }

    btnKirim.disabled = true;
    statusPengirim.textContent = 'Mengirim pesan...';

    setTimeout(() => {
      const namaLower = namaUntukRaw.toLowerCase();
      if (!dbPesan[namaLower]) {
        dbPesan[namaLower] = [];
      }
      dbPesan[namaLower].push(pesanKirimRaw);

      statusPengirim.textContent = 'Pesan berhasil dikirim! ðŸŽ‰';
      btnKirim.disabled = false;

      inputNamaUntuk.value = '';
      inputPesanKirim.value = '';
      inputPassword.value = '';
    }, 1500);
  });
</script>

</body>
</html>
