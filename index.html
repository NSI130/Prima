<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Penerima & Pengirim Interaktif</title>
<style>
  /* Reset & Base */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f5f7fa;
    margin: 0; 
    padding: 20px;
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 30px;
    min-height: 100vh;
    color: #334e68;
  }
  .box {
    background: #ffffffdd;
    border-radius: 16px;
    padding: 28px 32px;
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.15);
    width: 350px;
    max-width: 100%;
    user-select: none;
    display: flex;
    flex-direction: column;
  }
  h2 {
    color: #556cd6;
    margin-bottom: 20px;
    font-weight: 700;
    font-size: 1.4rem;
    text-align: center;
  }
  label {
    font-weight: 600;
    margin-bottom: 6px;
    color: #3e566c;
  }
  input, textarea {
    width: 100%;
    padding: 10px 14px;
    margin-bottom: 16px;
    border: 1.6px solid #cbd5e1;
    border-radius: 10px;
    font-size: 1rem;
    font-family: inherit;
    background: #f8fafc;
    color: #334e68;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }
  input:focus, textarea:focus {
    outline: none;
    border-color: #556cd6;
    box-shadow: 0 0 10px rgba(85, 108, 214, 0.35);
    background: #ffffff;
  }
  textarea {
    min-height: 90px;
    resize: vertical;
  }
  button {
    background: #6b7fd7;
    color: white;
    border: none;
    padding: 14px 20px;
    border-radius: 12px;
    cursor: pointer;
    font-weight: 700;
    font-size: 1.1rem;
    width: 100%;
    transition: background-color 0.3s ease;
  }
  button:hover:not(:disabled) {
    background: #4c5dbd;
  }
  button:disabled {
    background: #a0a7d9aa;
    cursor: not-allowed;
  }
  .message {
    margin-top: 14px;
    font-weight: 600;
    text-align: center;
    min-height: 38px;
    line-height: 1.4;
    color: #2e7d32;
    white-space: pre-wrap;
    font-family: 'Courier New', Courier, monospace;
  }
  .message.error {
    color: #d32f2f;
  }
  .spinner {
    margin: 18px auto;
    width: 36px;
    height: 36px;
    border: 4px solid #cbd5e1;
    border-top-color: #556cd6;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Animasi ketik */
  .typing {
    border-right: 2px solid #556cd6;
    white-space: nowrap;
    overflow: hidden;
    animation: typingAnim 1.5s steps(30, end), blinkCaret 0.75s step-end infinite;
  }
  @keyframes typingAnim {
    from { width: 0; }
    to { width: 100%; }
  }
  @keyframes blinkCaret {
    50% { border-color: transparent; }
  }

  /* Responsif */
  @media (max-width: 400px) {
    body {
      padding: 15px;
    }
    .box {
      width: 100%;
      padding: 24px;
    }
    h2 {
      font-size: 1.2rem;
    }
  }
</style>
</head>
<body>

<div class="box" aria-label="Bagian Penerima">
  <h2>Cek deh, ada pesan untukmu ngga</h2>
  <label for="namaPenerima">Masukkan namamu</label>
  <input type="text" id="namaPenerima" placeholder="Tulis namamu di sini..." autocomplete="off" />
  <button id="cekPesanBtn">Cek Pesan</button>
  <div id="statusPenerima" class="message" aria-live="polite"></div>
</div>

<div class="box" aria-label="Bagian Pengirim">
  <h2>Kirim Pesan Rahasia</h2>
  <label for="namaUntuk">Untuk siapa?</label>
  <input type="text" id="namaUntuk" placeholder="Nama penerima pesan" autocomplete="off" />
  
  <label for="pesanKirim">Isi Pesan</label>
  <textarea id="pesanKirim" placeholder="Tulis pesanmu di sini..."></textarea>
  
  <label for="passwordKirim">Password Rahasia</label>
  <input type="password" id="passwordKirim" placeholder="Masukkan password rahasia" autocomplete="off" />
  
  <button id="kirimPesanBtn">Kirim Pesan</button>
  <div id="statusPengirim" class="message" aria-live="polite"></div>
</div>

<script>
  // Simulasi database pesan
  // key: nama penerima lowercase, value: array pesan string
  const dbPesan = {
    'prima': ['Hai Prima! Semangat terus ya!', 'Jangan lupa makan yang teratur ðŸ˜Š'],
    'nashri': ['Halo Nashri, tetap jaga kesehatan!'],
  };

  const btnCek = document.getElementById('cekPesanBtn');
  const inputNamaPenerima = document.getElementById('namaPenerima');
  const statusPenerima = document.getElementById('statusPenerima');

  const btnKirim = document.getElementById('kirimPesanBtn');
  const inputNamaUntuk = document.getElementById('namaUntuk');
  const inputPesanKirim = document.getElementById('pesanKirim');
  const inputPassword = document.getElementById('passwordKirim');
  const statusPengirim = document.getElementById('statusPengirim');

  // Fungsi untuk tampilkan spinner loading
  function showSpinner(target) {
    target.innerHTML = '<div class="spinner" aria-label="Memuat..."></div>';
  }

  // Fungsi hilangkan spinner dan ganti pesan
  function hideSpinnerWithMessage(target, message, isError = false) {
    target.textContent = '';
    target.classList.toggle('error', isError);
    typeWriter(target, message);
  }

  // Fungsi animasi ketik (typewriter effect)
  function typeWriter(element, text, speed = 40) {
    element.classList.add('typing');
    let i = 0;
    element.textContent = '';
    function typing() {
      if (i < text.length) {
        element.textContent += text.charAt(i);
        i++;
        setTimeout(typing, speed);
      } else {
        element.classList.remove('typing');
      }
    }
    typing();
  }

  // Event cek pesan penerima
  btnCek.addEventListener('click', () => {
    const namaRaw = inputNamaPenerima.value.trim();
    if (!namaRaw) {
      hideSpinnerWithMessage(statusPenerima, 'Tolong isi namamu dulu ya!', true);
      return;
    }

    showSpinner(statusPenerima);

    // Simulasi delay 1.5 detik
    setTimeout(() => {
      const namaLower = namaRaw.toLowerCase();
      const pesanList = dbPesan[namaLower];

      if (pesanList && pesanList.length > 0) {
        // Tampilkan semua pesan dengan format rapi, tiap pesan baru di baris baru
        const semuaPesan = pesanList.map((p, i) => `${i+1}. ${p}`).join('\n');
        hideSpinnerWithMessage(statusPenerima, semuaPesan);
      } else {
        hideSpinnerWithMessage(statusPenerima, 
          'Maaf, belum ada pesan untukmu. Tetap semangat dan jangan menyerah!', false);
      }
    }, 1500);
  });

  // Event kirim pesan pengirim
  btnKirim.addEventListener('click', () => {
    const namaUntukRaw = inputNamaUntuk.value.trim();
    const pesanKirimRaw = inputPesanKirim.value.trim();
    const passRaw = inputPassword.value;

    if (!namaUntukRaw || !pesanKirimRaw || !passRaw) {
      statusPengirim.textContent = 'Semua kolom harus diisi ya!';
      statusPengirim.classList.add('error');
      return;
    }
    if (passRaw !== 'AraCintaNashri') {
      statusPengirim.textContent = 'Password rahasia salah, coba lagi ya!';
      statusPengirim.classList.add('error');
      return;
    }

    // Disable tombol supaya gak spam
    btnKirim.disabled = true;
    statusPengirim.classList.remove('error');
    statusPengirim.textContent = 'Mengirim pesan...';
    
    // Simulasi delay kirim pesan 1.5 detik
    setTimeout(() => {
      const namaLower = namaUntukRaw.toLowerCase();

      // Kalau penerima belum ada di db, buat array baru
      if (!dbPesan[namaLower]) {
        dbPesan[namaLower] = [];
      }
      dbPesan[namaLower].push(pesanKirimRaw);

      statusPengirim.textContent = 'Pesan berhasil dikirim! ðŸŽ‰';
      btnKirim.disabled = false;

      // Reset form pengirim
      inputNamaUntuk.value = '';
      inputPesanKirim.value = '';
      inputPassword.value = '';
    }, 1500);
  });
</script>

</body>
</html>
