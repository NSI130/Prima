<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Penerima & Pengirim Interaktif</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #eef2f7;
    margin: 0; padding: 20px;
    display: flex; flex-wrap: wrap; justify-content: center; gap: 30px;
  }
  .box {
    background: white;
    border-radius: 12px;
    padding: 24px 30px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    width: 350px;
    user-select: none;
  }
  h2 {
    color: #0d47a1;
    margin-bottom: 16px;
    text-align: center;
  }
  label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: #444;
  }
  input, textarea {
    width: 100%;
    padding: 10px 14px;
    margin-bottom: 16px;
    border: 1.8px solid #ccc;
    border-radius: 8px;
    font-size: 1rem;
    font-family: inherit;
    transition: border-color 0.3s ease;
  }
  input:focus, textarea:focus {
    outline: none;
    border-color: #0d47a1;
    box-shadow: 0 0 8px rgba(13,71,161,0.3);
  }
  textarea {
    min-height: 80px;
    resize: vertical;
  }
  button {
    background: #0d47a1;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 700;
    font-size: 1.1rem;
    width: 100%;
    transition: background-color 0.3s ease;
  }
  button:hover:not(:disabled) {
    background: #0842a0;
  }
  button:disabled {
    background: #0d47a1aa;
    cursor: not-allowed;
  }
  .message {
    margin-top: 12px;
    font-weight: 600;
    text-align: center;
    min-height: 28px;
    color: #2e7d32;
  }
  .message.error {
    color: #d32f2f;
  }
  .spinner {
    margin: 12px auto;
    width: 36px;
    height: 36px;
    border: 4px solid #ccc;
    border-top-color: #0d47a1;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
</style>
</head>
<body>

<div class="box" aria-label="Bagian Penerima">
  <h2>Halo Penerima!</h2>
  <label for="namaPenerima">Masukkan namamu</label>
  <input type="text" id="namaPenerima" placeholder="Tulis namamu di sini..." autocomplete="off" />
  <button id="cekPesanBtn">Cek Pesan</button>
  <div id="statusPenerima" class="message" aria-live="polite"></div>
</div>

<div class="box" aria-label="Bagian Pengirim">
  <h2>Kirim Pesan Rahasia</h2>
  <label for="namaUntuk">Untuk siapa?</label>
  <input type="text" id="namaUntuk" placeholder="Nama penerima pesan" autocomplete="off" />
  
  <label for="pesanKirim">Isi Pesan</label>
  <textarea id="pesanKirim" placeholder="Tulis pesanmu di sini..."></textarea>
  
  <label for="passwordKirim">Password Rahasia</label>
  <input type="password" id="passwordKirim" placeholder="Masukkan password rahasia" autocomplete="off" />
  
  <button id="kirimPesanBtn">Kirim Pesan</button>
  <div id="statusPengirim" class="message" aria-live="polite"></div>
</div>

<script>
  // Simulasi database pesan
  // key: nama penerima lowercase, value: array pesan string
  const dbPesan = {
    'prima': ['Hai Prima! Semangat terus ya!', 'Jangan lupa makan yang teratur ðŸ˜Š'],
    'nashri': ['Halo Nashri, tetap jaga kesehatan!'],
  };

  const btnCek = document.getElementById('cekPesanBtn');
  const inputNamaPenerima = document.getElementById('namaPenerima');
  const statusPenerima = document.getElementById('statusPenerima');

  const btnKirim = document.getElementById('kirimPesanBtn');
  const inputNamaUntuk = document.getElementById('namaUntuk');
  const inputPesanKirim = document.getElementById('pesanKirim');
  const inputPassword = document.getElementById('passwordKirim');
  const statusPengirim = document.getElementById('statusPengirim');

  // Fungsi untuk tampilkan spinner loading
  function showSpinner(target) {
    target.innerHTML = '<div class="spinner" aria-label="Memuat..."></div>';
  }

  // Fungsi hilangkan spinner dan ganti pesan
  function hideSpinnerWithMessage(target, message, isError = false) {
    target.textContent = message;
    target.classList.toggle('error', isError);
  }

  // Event cek pesan penerima
  btnCek.addEventListener('click', () => {
    const namaRaw = inputNamaPenerima.value.trim();
    if (!namaRaw) {
      hideSpinnerWithMessage(statusPenerima, 'Tolong isi namamu dulu ya!', true);
      return;
    }

    showSpinner(statusPenerima);

    // Simulasi delay 1.5 detik
    setTimeout(() => {
      const namaLower = namaRaw.toLowerCase();
      const pesanList = dbPesan[namaLower];

      if (pesanList && pesanList.length > 0) {
        // Tampilkan semua pesan dengan format rapi
        const semuaPesan = pesanList.map((p, i) => `${i+1}. ${p}`).join('\n');
        hideSpinnerWithMessage(statusPenerima, semuaPesan);
      } else {
        hideSpinnerWithMessage(statusPenerima, 
          'Maaf, belum ada pesan untukmu. Tetap semangat dan jangan menyerah!', false);
      }
    }, 1500);
  });

  // Event kirim pesan pengirim
  btnKirim.addEventListener('click', () => {
    const namaUntukRaw = inputNamaUntuk.value.trim();
    const pesanKirimRaw = inputPesanKirim.value.trim();
    const passRaw = inputPassword.value;

    if (!namaUntukRaw || !pesanKirimRaw || !passRaw) {
      statusPengirim.textContent = 'Semua kolom harus diisi ya!';
      statusPengirim.classList.add('error');
      return;
    }
    if (passRaw !== 'AraCintaNashri') {
      statusPengirim.textContent = 'Password rahasia salah, coba lagi ya!';
      statusPengirim.classList.add('error');
      return;
    }

    // Disable tombol supaya gak spam
    btnKirim.disabled = true;
    statusPengirim.classList.remove('error');
    statusPengirim.textContent = 'Mengirim pesan...';
    
    // Simulasi delay kirim pesan 1.5 detik
    setTimeout(() => {
      const namaLower = namaUntukRaw.toLowerCase();

      // Kalau penerima belum ada di db, buat array baru
      if (!dbPesan[namaLower]) {
        dbPesan[namaLower] = [];
      }
      dbPesan[namaLower].push(pesanKirimRaw);

      statusPengirim.textContent = 'Pesan berhasil dikirim! ðŸŽ‰';
      btnKirim.disabled = false;

      // Reset form pengirim
      inputNamaUntuk.value = '';
      inputPesanKirim.value = '';
      inputPassword.value = '';
    }, 1500);
  });
</script>

</body>
</html>
